/*frame by Ella Liu*/
FM.plugin.pwd_key=function(t){var n=this,e=-1!==window.location.host.indexOf("localhost")||-1!==window.location.host.indexOf("10.65");FM.helper.reqJs("/resource/js/plugin/sha256_key.js",function(){t=$.extend(!0,{em:$("input[data-encrypt-key]"),salt_url:"/api/srv/get_salt",pubkey:"-----BEGIN PUBLIC KEY-----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAyDUAJwoIlFZTBbxXvq0aT+SuYdcVdYY6+sRL7hmW7XvXBL+Mb4Bu4h/ZEU0cntO73kWAyLqrIF8sdd2x2ZuECgwZTPLFhYFFR1Fq7ZPLxHLzJYYWjRK7v9NzzqRBFsXyf902ybfY7KO9loLG8B0wjdOuli3wKO2u/gGif+9WCX55FqNa62udmeWFGBYrSQaj91vTMowpa2GSPmKqa59oKJqxnbRRQTQyw1lWUwQDuffyoPvKKEms4tz3D8wgB8Av5vJ+IO3f+nzjcMDMwJAhhuwHw1iy9r7DGiCT2zNgVRRoBakkN3Iv3pBMRqllRuz2JRUb9WXgQ5Ud09pa0zGeOwIDAQAB-----END PUBLIC KEY-----",RSAJSEncrypt:!1},t);this._init=function(){n.pre_submit=function(n,a){$.ajax({url:(e?"/api_mock/wcfpay"+t.salt_url:FM._data.siteurl+t.salt_url)+"?"+Math.random(),dataType:"json",type:"GET",success:function(e){function i(){t.em.each(function(){var n=$(this);n.data("cache_val",n.val()),t.RSAJSEncrypt||(t.RSAJSEncrypt=new FM.plugin.pwd_key.JSEncrypt,t.RSAJSEncrypt.setPublicKey(t.pubkey));var e=t.RSAJSEncrypt.encrypt(sha256_digest(n.val())+s);n.val(e)}),n()}if(e.body.salt){var s=e.body.salt;FM.helper.reqJs("/resource/js/plugin/rsa_key.js",function(){i()})}else a(e,"system error","salt can not get")},error:function(t,n,e){a(t,n,e)}})}},this.get_conf=function(){return t},this.pre_submit=function(){console.log("error, can not init safe component...")},this._init()})};